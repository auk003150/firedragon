<!DOCTYPE html>
<html>
<head>
    <title>æ–°æ˜¥å¤§å‘èˆç«é¾éŠæˆ²</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0, viewport-fit=cover">
    
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    
    <style>
        /* --- åŸºç¤è¨­å®š (ä¿æŒä¸è®Š) --- */
        html, body { 
            margin: 0; padding: 0; width: 100%; height: 100%; 
            overflow: hidden; font-family: 'Microsoft YaHei', sans-serif; 
            background-color: #000; 
        }
        #arjs-video {
            width: 100vw !important; height: 100vh !important;
            position: absolute !important; top: 0 !important; left: 0 !important;
            z-index: 0 !important; margin: 0 !important;
            object-fit: cover !important; transform: scaleX(-1) !important;
        }
        #global-bg {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: url('image_1.png') no-repeat center center;
            background-size: cover; z-index: 1; pointer-events: none; opacity: 0.9;
        }
        #ui-layer {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: 10; overflow: hidden;
        }
        #score-board, #timer-board {
            position: absolute; top: 20px;
            background: rgba(0, 0, 0, 0.6); padding: 10px 20px;
            border-radius: 15px; font-size: 20px; font-weight: bold;
            box-shadow: 0 4px 8px rgba(0,0,0,0.5);
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255,255,255,0.3);
        }
        #score-board { left: 20px; color: #ffeb3b; text-shadow: 0 0 5px #ff5722; }
        #timer-board { right: 20px; color: #fff; }

        #aim-cursor {
            position: absolute; width: 160px; height: 160px;
            transform: translate(-50%, -50%); display: none;
            justify-content: center; align-items: center;
            z-index: 20; 
        }
        #dragon-body-container {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: 15; 
        }

        /* --- çç è‰æè³ª --- */
        .straw-texture {
            background-color: #d4b483; 
            background-image: 
                radial-gradient(circle at 30% 30%, rgba(255,255,255,0.4) 0%, transparent 50%),
                linear-gradient(to bottom, rgba(0,0,0,0.1), transparent 20%, transparent 80%, rgba(0,0,0,0.4)),
                repeating-linear-gradient(85deg, transparent 0px, transparent 2px, rgba(93, 64, 55, 0.3) 3px, transparent 4px),
                repeating-linear-gradient(95deg, transparent 0px, transparent 3px, rgba(141, 110, 99, 0.4) 4px, transparent 6px),
                repeating-linear-gradient(0deg, rgba(0,0,0,0.05) 0px, rgba(0,0,0,0.05) 1px, transparent 1px, transparent 5px);
            border: 1px solid #8d6e63;
            box-shadow: inset 0 0 10px rgba(62, 39, 35, 0.5);
        }

        /* --- é¾é ­æ¨£å¼ --- */
        .dragon-head-group {
            position: relative; width: 120px; height: 120px;
            animation: float-head 2s ease-in-out infinite;
        }
        .dh-skull { position: absolute; top: 25px; left: 20px; width: 80px; height: 60px; border-radius: 25px 25px 15px 15px; z-index: 5; }
        .dh-snout { position: absolute; top: 50px; left: 10px; width: 90px; height: 40px; border-radius: 30px; z-index: 6; }
        .dh-snout::before, .dh-snout::after { content: ''; position: absolute; bottom: 10px; width: 14px; height: 14px; background: #3e2723; border-radius: 50%; box-shadow: inset 0 0 5px #000; }
        .dh-snout::before { left: 15px; } .dh-snout::after { right: 15px; }
        .dh-jaw { position: absolute; bottom: 10px; left: 30px; width: 60px; height: 35px; border-radius: 0 0 25px 25px; z-index: 4; animation: chew 1s ease-in-out infinite alternate; }
        
        /* 
           ğŸ‘€ ä¿®æ”¹è™•ï¼šé¾çœ¼æ¨£å¼ (ç™½è‰²ç‰ˆ) ğŸ‘€ 
        */
        .dh-eye { 
            position: absolute; top: 20px; width: 24px; height: 24px; 
            /* 
               1. æ¼¸å±¤æ”¹ç‚ºç™½è‰²ç³»ï¼šä¸­å¿ƒç´”ç™½ -> é‚Šç·£å¾®ç° (#cfd8dc) 
            */
            background: radial-gradient(circle, #fff 40%, #cfd8dc 100%);
            border-radius: 50%; 
            border: 3px solid #3e2723; 
            /* 
               2. ç™¼å…‰æ”¹ç‚ºç™½è‰²å…‰æšˆ 
            */
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.9); 
            z-index: 7; 
        }
        
        .eye-left { left: 5px; } .eye-right { right: 5px; }
        .dh-horn { position: absolute; top: -25px; width: 15px; height: 55px; border-radius: 8px; transform-origin: bottom center; z-index: 3; }
        .horn-left { left: 15px; transform: rotate(-25deg); } .horn-right { right: 15px; transform: rotate(25deg); }
        .dh-whisker { position: absolute; top: 60px; width: 70px; height: 50px; border-top: 5px solid #a1887f; border-radius: 50%; z-index: 2; opacity: 0.9; filter: drop-shadow(0 2px 2px rgba(0,0,0,0.5)); }
        .whisker-left { right: 85px; transform: rotate(20deg); } .whisker-right { left: 85px; transform: rotate(-20deg); }

        /* --- é¾èº«æ¨£å¼ --- */
        .dragon-body-segment {
            position: absolute;
            width: 65px; height: 65px;
            border-radius: 45% 55% 50% 50%; 
            transform: translate(-50%, -50%);
            display: none; 
            z-index: 15;
        }

        /* æ“¬çœŸé¦™ç«ç‰¹æ•ˆ */
        .dragon-body-segment::before {
            content: '';
            position: absolute;
            top: 50%; left: 50%;
            width: 4px; height: 4px; 
            border-radius: 50%;
            transform: translate(-50%, -50%);
            background: radial-gradient(circle, #fff 20%, #ffeb3b 40%, #ff3d00 100%);
            box-shadow: 
                0px -28px 2px #ff1744, 
                6px -26px 1px #ff5722,
                -6px -26px 2px #ff5722,
                12px -22px 1px #ff9100,
                -12px -22px 2px #ff9100,
                18px -15px 1px #ff3d00,
                -18px -15px 2px #ff3d00,
                22px -6px 1px #ff1744,
                -22px -6px 2px #ff1744,
                24px 5px 1px #ff5722,
                -24px 5px 2px #ff5722,
                18px 16px 1px #ff9100,
                -18px 16px 2px #ff9100,
                0px 0px 8px rgba(255, 200, 0, 0.8); 
            filter: drop-shadow(0 0 2px rgba(255, 61, 0, 0.8));
            animation: incense-flicker 0.1s infinite alternate;
        }

        .dragon-body-segment::after {
            content: ''; position: absolute; top: -15px; left: -15px; right: -15px; bottom: -15px;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(255, 87, 34, 0.15) 30%, transparent 70%);
            z-index: -1;
            filter: blur(8px);
            animation: smoke-pulse 2s infinite ease-in-out;
        }

        /* --- é¾å°¾æ¨£å¼ --- */
        .dragon-tail {
            position: absolute; width: 50px; height: 90px;
            clip-path: polygon(40% 0%, 60% 0%, 100% 30%, 85% 100%, 15% 100%, 0% 30%);
            transform: translate(-50%, -50%); display: none;
        }
        .dragon-tail::before {
            content: ''; position: absolute; top: 20px; left: 50%; width: 3px; height: 3px;
            background: radial-gradient(circle, #fff 10%, #ff3d00 100%);
            box-shadow: 
                0 10px 1px #ff9100, 0 20px 2px #ff3d00, 0 30px 1px #ff1744,
                -10px 15px 2px #ff9100, 10px 15px 1px #ff3d00,
                -15px 25px 2px #ff5722, 15px 25px 1px #ff5722;
            filter: drop-shadow(0 0 2px #ff3d00);
            animation: incense-flicker 0.15s infinite alternate;
        }

        @keyframes incense-flicker { 
            0% { opacity: 0.8; transform: translate(-50%, -50%) scale(0.95); filter: drop-shadow(0 0 1px rgba(255,61,0,0.5)); } 
            50% { opacity: 1; transform: translate(-50%, -50%) scale(1.1); filter: drop-shadow(0 0 3px rgba(255,200,0,0.8)); } 
            100% { opacity: 0.9; transform: translate(-50%, -50%) scale(1.0); filter: drop-shadow(0 0 2px rgba(255,61,0,0.6)); } 
        }

        @keyframes smoke-pulse {
            0%, 100% { opacity: 0.3; transform: scale(1); }
            50% { opacity: 0.6; transform: scale(1.1); }
        }

        /* è£é£¾ç”¨çš„é¦™ç«ç‰¹æ•ˆ (é¾é ­) */
        .incense-glow { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 10; }
        .incense-particles { 
            position: absolute; width: 4px; height: 4px; 
            background: radial-gradient(circle, #fff 20%, #ff3d00 100%);
            border-radius: 50%; top: 40%; left: 50%; 
            box-shadow: 
                0 -35px 2px #ff9100, 10px -32px 1px #ff3d00, -10px -32px 2px #ff3d00, 
                20px -28px 1px #ff9100, -20px -28px 2px #ff3d00, 30px -20px 1px #ff3d00, -30px -20px 2px #ff9100; 
            filter: drop-shadow(0 0 4px #ff3d00); 
            animation: incense-flicker 0.12s infinite alternate; 
        }
        
        .smoke-effect { 
            position: absolute; top: -40px; left: 50%; width: 15px; height: 15px; 
            background: rgba(220,220,220,0.4); border-radius: 50%; 
            box-shadow: 0 0 25px 15px rgba(220,220,220,0.4); 
            transform: translateX(-50%); 
            animation: smoke-rise 2.5s infinite linear; 
            z-index: 1; 
        }
        @keyframes smoke-rise { 
            0% { opacity: 0; transform: translate(-50%, 0) scale(0.5); } 
            50% { opacity: 0.5; } 
            100% { opacity: 0; transform: translate(-50%, -80px) scale(2.5); } 
        }
        @keyframes float-head { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-8px); } }
        @keyframes chew { 0% { transform: translateY(0); } 100% { transform: translateY(5px); } }

        /* --- æ‰è½ç‰©é«”æ¨£å¼ --- */
        .floating-item { position: absolute; font-size: 40px; font-weight: bold; display: flex; justify-content: center; align-items: center; width: 70px; height: 70px; border-radius: 50%; background: rgba(255, 255, 255, 0.9); box-shadow: 0 4px 10px rgba(0,0,0,0.3); z-index: 5; will-change: transform, left, top; }
        .good-item { color: #d32f2f; border: 3px solid #d32f2f; }
        .bad-item { color: #333; border: 3px solid #555; }
        .score-popup { position: absolute; font-size: 36px; font-weight: 900; text-shadow: 1px 1px 0 #fff; animation: floatUp 0.8s ease-out forwards; z-index: 20; }
        @keyframes floatUp { 0% { opacity: 1; transform: translateY(0); } 100% { opacity: 0; transform: translateY(-60px); } }
        .overlay-screen { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 30; pointer-events: auto; color: white; text-align: center; }
        button { padding: 15px 40px; font-size: 22px; background: #d32f2f; color: white; border: none; border-radius: 50px; cursor: pointer; margin-top: 20px; font-weight: bold; box-shadow: 0 0 15px #ff5252; transition: transform 0.1s; }
        button:active { transform: scale(0.95); }
        #mute-btn { position: absolute; bottom: 20px; right: 20px; z-index: 40; background: rgba(255,255,255,0.5); border: none; padding: 10px; border-radius: 50%; font-size: 24px; cursor: pointer; pointer-events: auto; }
    </style>
</head>
<body>

    <audio id="bgm" loop>
        <source src="https://actions.google.com/sounds/v1/ambiences/carnival_atmosphere.ogg" type="audio/ogg">
    </audio>
    <audio id="sfx-collect">
        <source src="Collect.mp3" type="audio/mp3">
    </audio>
    <audio id="sfx-crunch">
        <source src="Crunch.mp3" type="audio/mp3">
    </audio>
    <audio id="sfx-end">
        <source src="https://actions.google.com/sounds/v1/cartoon/clown_horn.ogg" type="audio/ogg">
    </audio>

    <div id="global-bg"></div>

    <div id="ui-layer">
        <div id="score-board">åˆ†æ•¸: <span id="score">0</span></div>
        <div id="timer-board">æ™‚é–“: <span id="timer">60</span></div>
        
        <div id="dragon-body-container"></div>

        <div id="aim-cursor">
            <div class="dragon-head-group">
                <div class="smoke-effect"></div>
                <div class="dh-horn horn-left straw-texture"></div>
                <div class="dh-horn horn-right straw-texture"></div>
                <div class="dh-whisker whisker-left"></div>
                <div class="dh-whisker whisker-right"></div>
                <div class="dh-skull straw-texture"></div>
                <div class="dh-jaw straw-texture"></div>
                <div class="dh-snout straw-texture"></div>
                <div class="dh-eye eye-left"></div>
                <div class="dh-eye eye-right"></div>
                <div class="incense-glow">
                    <div class="incense-particles"></div>
                </div>
            </div>
        </div>

        <div id="game-area"></div>
        <button id="mute-btn" onclick="toggleMute()">ğŸ”Š</button>
    </div>

    <div id="start-screen" class="overlay-screen">
        <h1 style="color:#ffeb3b; text-shadow: 0 0 10px #ff5722; font-size: 40px;">ğŸ”¥ å¤§å‘èˆç«é¾ ğŸ”¥</h1>
        <p style="font-size: 18px; color: #ddd;">è«‹æº–å‚™å¥½ Hiro Marker<br>æ§åˆ¶é¾é ­æ”¶é›†å‰ç¥¥å­—ï¼</p>
        <button onclick="startGame()">èµ·é¾ï¼(Start)</button>
    </div>

    <div id="game-over-screen" class="overlay-screen" style="display: none;">
        <h1>æ™‚é–“åˆ°ï¼</h1>
        <p>æœ€çµ‚åˆ†æ•¸: <span id="final-score" style="font-size: 40px; font-weight: bold; color: #ffeb3b;">0</span></p>
        <button onclick="startGame()">å†èˆä¸€æ¬¡</button>
    </div>

    <a-scene embedded arjs='sourceType: webcam; debugUIEnabled: false; detectionMode: mono_and_matrix; matrixCodeType: 3x3;' vr-mode-ui="enabled: false">
        <a-entity camera></a-entity>
        <a-marker preset="hiro" id="player-marker"></a-marker>
    </a-scene>

    <script>
        // --- éŸ³æ•ˆç®¡ç† ---
        const sounds = {
            bgm: document.getElementById('bgm'),
            collect: document.getElementById('sfx-collect'),
            crunch: document.getElementById('sfx-crunch'), 
            end: document.getElementById('sfx-end')
        };
        let isMuted = false;
        sounds.bgm.volume = 0.3; 
        sounds.collect.volume = 0.8;
        sounds.crunch.volume = 0.8; 

        function playSound(name) {
            if (isMuted) return;
            const audio = sounds[name];
            if (audio) { 
                audio.currentTime = 0; 
                audio.play().catch(e => console.log("Audio play failed:", e)); 
            }
        }

        function toggleMute() {
            isMuted = !isMuted;
            const btn = document.getElementById('mute-btn');
            if (isMuted) { sounds.bgm.pause(); btn.innerText = 'ğŸ”‡'; } 
            else { if(isGameRunning) sounds.bgm.play(); btn.innerText = 'ğŸ”Š'; }
        }

        // --- éŠæˆ²è®Šæ•¸ ---
        const goodWords = ['ç¦', 'æ˜¥', 'è²¡', 'å®‰', 'æ—º', 'å‰', 'ç¥¥', 'è³€', 'é¦¬', 'å¹´'];
        const badWords = ['âš½', 'ğŸ”', 'ğŸ§', 'ğŸ§Š', 'ğŸ§¼', 'ğŸº', 'ğŸ’¡', 'ğŸ“', 'ğŸ§½', 'ğŸ§¯'];
        let score = 0;
        let timeLeft = 60;
        let isGameRunning = false;
        let items = []; 
        let timerInterval = null;
        let gameWidth = window.innerWidth;
        let gameHeight = window.innerHeight;
        let playerScreenPos = { x: -100, y: -100, visible: false };

        const bodySegmentCount = 8;
        const bodySegments = [];
        const bodyPositions = [];
        const bodySpacing = 45;

        const gameArea = document.getElementById('game-area');
        const scoreEl = document.getElementById('score');
        const timerEl = document.getElementById('timer');
        const aimCursor = document.getElementById('aim-cursor');
        const dragonBodyContainer = document.getElementById('dragon-body-container');
        const playerMarker = document.getElementById('player-marker');
        const startScreen = document.getElementById('start-screen');
        const gameOverScreen = document.getElementById('game-over-screen');
        const finalScoreEl = document.getElementById('final-score');

        // --- åˆå§‹åŒ–é¾èº« ---
        function initDragonBody() {
            dragonBodyContainer.innerHTML = '';
            bodySegments.length = 0;
            bodyPositions.length = 0;

            for (let i = 0; i < bodySegmentCount; i++) {
                const el = document.createElement('div');
                el.classList.add('dragon-body-segment');
                el.classList.add('straw-texture');
                const scale = 1 - (i * 0.04);
                el.style.transform = `translate(-50%, -50%) scale(${scale})`;
                
                dragonBodyContainer.appendChild(el);
                bodySegments.push(el);
                bodyPositions.push({ x: -100, y: -100 });
            }

            const tail = document.createElement('div');
            tail.classList.add('dragon-tail');
            tail.classList.add('straw-texture');
            dragonBodyContainer.appendChild(tail);
            bodySegments.push(tail);
            bodyPositions.push({ x: -100, y: -100 });
        }

        function fixVideoSize() {
            const video = document.getElementById('arjs-video');
            if (video) {
                video.style.width = window.innerWidth + 'px';
                video.style.height = window.innerHeight + 'px';
                video.style.objectFit = 'cover';
                video.style.marginLeft = '0px';
                video.style.marginTop = '0px';
            }
        }

        window.addEventListener('resize', () => {
            gameWidth = window.innerWidth;
            gameHeight = window.innerHeight;
            fixVideoSize();
        });

        const videoCheckInterval = setInterval(() => {
            const video = document.getElementById('arjs-video');
            if (video) {
                fixVideoSize();
                video.addEventListener('loadedmetadata', fixVideoSize);
                video.addEventListener('play', fixVideoSize);
                clearInterval(videoCheckInterval);
            }
        }, 500);

        function startGame() {
            if (!isMuted) sounds.bgm.play().catch(e => console.log("BGM play failed:", e));

            startScreen.style.display = 'none';
            gameOverScreen.style.display = 'none';
            
            score = 0;
            timeLeft = 60;
            scoreEl.innerText = score;
            timerEl.innerText = timeLeft;
            gameArea.innerHTML = '';
            items = [];
            isGameRunning = true;

            initDragonBody();
            fixVideoSize();
            spawnItems(6, 'good'); 
            spawnItems(4, 'bad');  
            
            gameLoop();

            if (timerInterval) clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                timeLeft--;
                timerEl.innerText = timeLeft;
                if (timeLeft <= 0) endGame();
            }, 1000);
        }

        function endGame() {
            isGameRunning = false;
            clearInterval(timerInterval);
            sounds.bgm.pause(); sounds.bgm.currentTime = 0;
            playSound('end');
            finalScoreEl.innerText = score;
            gameOverScreen.style.display = 'flex';
        }

        function spawnItems(count, type) {
            for (let i = 0; i < count; i++) {
                const el = document.createElement('div');
                el.classList.add('floating-item');
                el.classList.add(type === 'good' ? 'good-item' : 'bad-item');
                el.innerText = type === 'good' ? 
                    goodWords[Math.floor(Math.random() * goodWords.length)] : 
                    badWords[Math.floor(Math.random() * badWords.length)];
                el.dataset.points = type === 'good' ? 15 : -5;
                gameArea.appendChild(el);
                const size = 70;
                items.push({
                    element: el,
                    x: Math.random() * (gameWidth - size),
                    y: Math.random() * (gameHeight - size),
                    vx: (Math.random() - 0.5) * 4,
                    vy: (Math.random() - 0.5) * 4,
                    width: size, height: size,
                    active: true
                });
            }
        }

        function updateDragonBody(headX, headY) {
            let targetX = headX;
            let targetY = headY;

            for (let i = 0; i < bodySegments.length; i++) {
                const segment = bodySegments[i];
                const currentPos = bodyPositions[i];

                const dx = targetX - currentPos.x;
                const dy = targetY - currentPos.y;
                const dist = Math.sqrt(dx*dx + dy*dy);
                const angle = Math.atan2(dy, dx);

                if (dist > bodySpacing) {
                    const moveDist = dist - bodySpacing;
                    currentPos.x += Math.cos(angle) * moveDist * 0.5;
                    currentPos.y += Math.sin(angle) * moveDist * 0.5;
                }

                segment.style.display = 'block';
                segment.style.left = currentPos.x + 'px';
                segment.style.top = currentPos.y + 'px';
                
                if (i === bodySegments.length - 1) {
                    segment.style.transform = `translate(-50%, -50%) rotate(${angle * 180 / Math.PI + 90}deg)`;
                } else {
                    const scale = 1 - (i * 0.04);
                    segment.style.transform = `translate(-50%, -50%) scale(${scale})`;
                }

                targetX = currentPos.x;
                targetY = currentPos.y;
            }
        }

        function gameLoop() {
            if (!isGameRunning) return;
            
            if (playerMarker.object3D.visible) {
                const vector = new THREE.Vector3();
                playerMarker.object3D.getWorldPosition(vector);
                
                const camera = document.querySelector('a-scene').camera;
                vector.project(camera);

                const screenX = ((-vector.x + 1) / 2) * gameWidth;
                const screenY = ((-vector.y + 1) / 2) * gameHeight;

                playerScreenPos = { x: screenX, y: screenY, visible: true };

                aimCursor.style.display = 'flex';
                aimCursor.style.left = screenX + 'px';
                aimCursor.style.top = screenY + 'px';

                updateDragonBody(screenX, screenY);

            } else {
                playerScreenPos.visible = false;
                aimCursor.style.display = 'none';
                bodySegments.forEach(seg => seg.style.display = 'none');
            }

            items.forEach(item => {
                if (!item.active) return;
                item.x += item.vx; item.y += item.vy;
                if (item.x <= 0 || item.x >= gameWidth - item.width) item.vx *= -1;
                if (item.y <= 0 || item.y >= gameHeight - item.height) item.vy *= -1;
                item.x = Math.max(0, Math.min(item.x, gameWidth - item.width));
                item.y = Math.max(0, Math.min(item.y, gameHeight - item.height));
                item.element.style.left = item.x + 'px'; item.element.style.top = item.y + 'px';

                if (playerScreenPos.visible) {
                    const dx = playerScreenPos.x - (item.x + item.width/2);
                    const dy = playerScreenPos.y - (item.y + item.height/2);
                    if ((dx*dx + dy*dy) < (60 + 35)**2) {
                        handleHit(item);
                    }
                }
            });

            requestAnimationFrame(gameLoop);
        }

        function handleHit(item) {
            const pts = parseInt(item.element.dataset.points);
            score += pts;
            scoreEl.innerText = score;
            
            if (pts > 0) {
                playSound('collect'); 
            } else {
                playSound('crunch');  
            }

            const popup = document.createElement('div');
            popup.classList.add('score-popup');
            popup.innerText = pts > 0 ? `+${pts}` : pts;
            popup.style.color = pts > 0 ? '#2e7d32' : '#d32f2f';
            popup.style.left = item.x + 'px'; popup.style.top = item.y + 'px';
            gameArea.appendChild(popup);
            setTimeout(() => popup.remove(), 800);
            item.active = false; item.element.style.opacity = '0';
            setTimeout(() => {
                if (!isGameRunning) return;
                item.active = true; item.element.style.opacity = '1';
                item.x = Math.random() * (gameWidth - item.width);
                item.y = Math.random() * (gameHeight - item.height);
                item.element.innerText = pts > 0 ? goodWords[Math.floor(Math.random() * goodWords.length)] : badWords[Math.floor(Math.random() * badWords.length)];
            }, 500);
        }
    </script>
</body>
</html>
